<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>News from the Fraser Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="This is the official web page for the James Fraser Lab at UCSF.">
    <meta name="theme-color" content="#7fab91">
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/static/css/syntax.css" rel="stylesheet">
    <link href="/static/css/custom.css" rel="stylesheet">
    
    <link rel="alternate" type="application/atom+xml" title="Fraser Lab News Feed" href="/news.xml">
    
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Static navbar -->
      <div class="navbar navbar-fixed-top navbar-default" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Fraser Lab @ UCSF</a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              
                
                  <li><a href="/" alt="home"> home</a></li>
                
              
                
                  <li><a href="/research" alt="research"> research</a></li>
                
              
                
                  <li><a href="/publications" alt="publications"> publications</a></li>
                
              
                
                  <li><a href="/members" alt="members"> members</a></li>
                
              
                
                  <li class = "active"><a href="/news" alt="news"> news</a></li>
                
              
                
                  <li><a href="/contact" alt="contact"> contact</a></li>
                
              
                
                  <li><a href="https://sites.google.com/a/fraserlab.com/ucsf-private/" alt="private"> private</a></li>
                
              
              <!-- <li><a href="https://sites.google.com/a/fraserlab.com/ucsf-private/" alt="Lab Private Area">private</a></li> -->
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->
      </div>

    <div class="container">


<div class="row-fluid">
    <div class="col-sm-7 col-md-8">
        <div class = "page header"><h1>News from the Fraser Lab</h1></div>
        <!-- This loops through the paginated posts -->

  <hr>
  <h2><a href="/2014/08/30/ALS-Ice-Bucket-challenge/">James takes the Ice Bucket Challenge</a></h2>
  <p class="author">
    <span class="author"><a href="/members#James Fraser">James Fraser</a></span><br>
    <span class="date"><em>30 August 2014</em></span>
  </p>
  <div class="content">
    <p>Yesterday <a href="http://web.stanford.edu/group/kimlab/">Peter Kim</a> presented me (and <a href="http://www.msg.ucsf.edu/stroud/index.htm">Bob Stroud</a> and <a href="http://www.craiklab.ucsf.edu/">Charly Craik</a>) with the <a href="http://www.alsa.org/fight-als/ice-bucket-challenge.html">Ice Bucket Challenge</a>. Peter and Susan Marqusee were challenged by <a href="https://www.youtube.com/watch?v=-ils6pggkGg">Terry Oas</a>. This fundraiser holds special significance for all of us because Tom Alber, our friend and my PhD advisor, recently passed away from ALS. I think that Tom would have loved the Ice Bucket Challenge.</p>

<div class="video-container">
         <iframe src="//www.youtube.com/embed/fQ7p9mHDJUw" frameborder="0" width="560" height="315"></iframe>
</div>
<br>
<div class="video-container">
         <iframe src="//www.youtube.com/embed/9VrzhmSkqfQ" frameborder="0" width="560" height="315"></iframe>
</div>

<p>Tom was incredibly courageous during the final years of his life. He never stopped learning about the underlying mechanisms of ALS and thinking of potential therapies. It was very painful to see him disappointed again and again by the ineffectiveness of the available treatments. Some of this disappointment is due to general difficulties in developing treatments for neurodegenerative diseases, but some of it was due to our lack of knowledge about the basic mechanisms of this disease.</p>

<div class="video-container">
         <iframe src="//www.youtube.com/embed/UJ2mUbhzWic" frameborder="0" width="560" height="315"></iframe>
</div>

<p>I challenged <a href="http://michaeleisen.org">Michael Eisen</a>, <a href="http://valelab.ucsf.edu/">Ron Vale</a>, and <a href="http://www.usfca.edu/sds/staff/">Barb Zunder</a>. Barb will help spread the message to USF. I hope that Ron will take the challenge, donate, and work to invite a top ALS researcher to create an <a href="http://www.ibiology.org/ibioseminars.html">iBioseminar</a> or <a href="http://www.ibiology.org/ibiomagazine.html">iBiomagazine</a> video about ALS. There is a real opportunity for <a href="http://www.ibiology.org/">iBiology</a> to use their production platform to capture the spirit of the moment. They can produce a fantastic video that describes the challenges and recent successes in understanding basic mechanisms of neurodegenerative disease.</p>

<p>Mike is refusing to accept the challenge to make a larger point about the relationship between funding agencies, research, and public access to research findings.  I sympathize with his point. I know that Tom was always up to date on ALS research because of the journal access afforded to him as a professor at UC Berkeley.  Other patients do not have this access and that is a shame. I hope that Mike will still donate to <a href="https://secure2.convio.net/alsa/site/Donation2;jsessionid=FB956D73A15162C5668CD3AD9D926FC3.app293b?df_id=27420&amp;27420.donation=form1">The ALS Association</a> or to a lecture <a href="http://givetocal.berkeley.edu/browse/?u=383">established in Tom’s memory at UC Berkeley</a>, or both. In the meantime, here are a few open-access papers on the subject of Amyotrophic lateral sclerosis:</p>

<ul>
  <li><a href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.0060170">Protein Aggregation and Protein Instability Govern Familial Amyotrophic Lateral Sclerosis Patient Survival</a></li>
  <li><a href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001052">A Yeast Model of FUS/TLS-Dependent Cytotoxicity</a>, by Greg Petkso (who was Tom’s PhD Advisor)</li>
  <li><a href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1000614">Molecular Determinants and Genetic Modifiers of Aggregation and Toxicity for the ALS Disease Protein FUS/TLS</a></li>
  <li><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1002214">FUS and TARDBP but Not SOD1 Interact in Genetic Models of Amyotrophic Lateral Sclerosis</a></li>
  <li><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1000193">Novel Mutations in TARDBP (TDP-43) in Patients with Familial Amyotrophic Lateral Sclerosis</a></li>
  <li><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1000350">An ALS-Linked Mutant SOD1 Produces a Locomotor Defect Associated with Aggregation and Synaptic Dysfunction When Expressed in Neurons of Caenorhabditis elegans</a></li>
  <li><a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1003895">ALS-Associated FUS Mutations Result in Compromised FUS Alternative Splicing and Autoregulation</a>
-<a href="http://dx.plos.org/10.1371/journal.pone.0010064">Metal-Free ALS Variants of Dimeric Human Cu,Zn-Superoxide Dismutase Have Enhanced Populations of Monomeric Species</a>, by Bob Matthews (one of Tom’s best friends)</li>
</ul>

<p>I’ll add more links as people send or comment on them.  Fortunately, due to the hard work of people like Mike, many classic papers are now available through Pubmed Central and most journals now deposit articles after an embargo period.  In diseases like ALS where it is often only a matter of a few years between diagnosis and death, an embargo of 18 months to protect journal profits seems particular unjust.</p>

<p><strong><a href="http://givetocal.berkeley.edu/browse/?u=383">Consider making a donation to establish an infectious disease lectureship in Tom’s name at UC Berkeley</a>
and to <a href="https://secure2.convio.net/alsa/site/Donation2;jsessionid=FB956D73A15162C5668CD3AD9D926FC3.app293b?df_id=27420&amp;27420.donation=form1">The ALS Association</a></strong></p>

  </div>

  <hr>
  <h2><a href="/bk/2014/08/26/Pymol-highlighting/">Syntax Highlighting for Pymol Scripts</a></h2>
  <p class="author">
    <span class="author"><a href="/members#Ben Barad">Ben Barad</a></span><br>
    <span class="date"><em>26 August 2014</em></span>
  </p>
  <div class="content">
    <p><img class="img-responsive" src="/static/img/pymol/Combined_screenshots.png" alt="Screenshots of pymol script before and after syntax highlighting" /></p>

<p>We write lots of pymol scripts here in the Fraser lab, and to this end I have written a language grammar to allow highlighting of the pymol syntax in <code class="highlighter-rouge">.pml</code> files in <a href="https://www.sublimetext.com/">Sublime Text</a> (and any other editor that uses textmate style grammars). It should work with just about any basic syntax that you throw at it, though more capability (for things like for loops) will be added as time goes on.</p>

<p>It is publically available for installation through <a href="https://sublime.wbond.net/packages/Pymol%20Language">Package Control</a>, which will automatically update with new releases. You can also get it from <a href="https://github.com/bbarad/pymol_syntax">Github</a>, which will have the most up to date changes between releases (including potential new bugs).</p>

<p><em>For the curious, I wrote a longer article discussing the details of making the language grammar, and where it currently stands, on <a href="http://benjaminbarad.com/2014/08/26/Pymol-highlighting/">my personal website</a>.</em></p>

  </div>

  <hr>
  <h2><a href="/2014/08/26/Pymol-highlighting/">Syntax Highlighting for Pymol Scripts</a></h2>
  <p class="author">
    <span class="author"><a href="/members#Ben Barad">Ben Barad</a></span><br>
    <span class="date"><em>26 August 2014</em></span>
  </p>
  <div class="content">
    <p><img class="img-responsive" src="/static/img/pymol/Combined_screenshots.png" alt="Screenshots of pymol script before and after syntax highlighting" /></p>

<p>We write lots of pymol scripts here in the Fraser lab, and to this end I have written a language grammar to allow highlighting of the pymol syntax in <code class="highlighter-rouge">.pml</code> files in <a href="https://www.sublimetext.com/">Sublime Text</a> (and any other editor that uses textmate style grammars). It should work with just about any basic syntax that you throw at it, though more capability (for things like for loops) will be added as time goes on.</p>

<p>It is publically available for installation through <a href="https://sublime.wbond.net/packages/Pymol%20Language">Package Control</a>, which will automatically update with new releases. You can also get it from <a href="https://github.com/bbarad/pymol_syntax">Github</a>, which will have the most up to date changes between releases (including potential new bugs).</p>

<p><em>For the curious, I wrote a longer article discussing the details of making the language grammar, and where it currently stands, on <a href="http://benjaminbarad.com/2014/08/26/Pymol-highlighting/">my personal website</a>.</em></p>

  </div>

  <hr>
  <h2><a href="/bk/2014/08/20/Figures-with-Python/">Making Publication-quality Charts using Python and Matplotlib</a></h2>
  <p class="author">
    <span class="author"><a href="/members#Ben Barad">Ben Barad</a></span><br>
    <span class="date"><em>20 August 2014</em></span>
  </p>
  <div class="content">
    <p><em>I originally wrote this article for my <a href="http://benjaminbarad.com">personal website</a>, but I think it is relevant here, so with James’s blessing I am crossposting it.</em></p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test_no_title.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p><a href="https://www.python.org/">Python</a> is currently my programming language of choice. It is the programming language taught by my graduate program to incoming first years, and in my experience it is the most common scripting language used by the scientists around me. The Fraser lab uses python almost exclusively for programming.</p>

<p>Because of this, when I want to work with data my first instinct is to go to python. Python is very effective for importing data, doing all of the manipulations necessary, and performing statistical tests. Ultimately, while I am aware that there are a multitude of <a href="http://www.r-project.org/">other</a> <a href="http://julialang.org/">tools</a> available, I would rather stick with python.</p>

<p>In my experience, the most painful part of using python for data analysis is <strong>visualization</strong>. Plotting in python is primarily accomplished via <a href="http://matplotlib.org/">Matplotlib</a>. I find the syntax fairly straightforward, but the default output of the charts leave much to be desired. In particular, I find myself messing with the spacing between the labels and the graph, the size of the labels and title, the linewidth, the colors of the objects, and the visual appearance of the regular tickmarks all to make a single figure look appealing enough to share with my peers. Trying to do this consistently is even more maddening, as it ultimately results in even more boilerplate code.</p>

<p>I ultimately (mostly) solved this problem by creating a matplotlibrc file which automatically imports a number of settings for every chart I choose to work with. My matplotlibrc file lives in a <a href="https://github.com/bbarad/matplotlibrc">github repository</a> where you can freely grab and modify it. Just put it in your <code class="highlighter-rouge">~/.matplotlib/</code> folder. I also thought I would use this space to talk about the decisions I made in designing the matplotlibrc to get as close as possible to publication quality images with no special styles in the python code.</p>

<!--break-->

<h2 id="matplotlibs-defaults-are-unsuitable-for-any-professional-purpose">Matplotlib’s defaults are unsuitable for any professional purpose</h2>

<p>The best way for me to show the problems with the defaults in matplotlib is to show the output of a small snippet of code:</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">220</span><span class="p">,</span><span class="mf">14.2</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">420</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">"center"</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="s">'wt'</span><span class="p">,</span> <span class="s">'N23PP'</span><span class="p">,</span> <span class="s">'N23PP/PEKN'</span><span class="p">,</span> <span class="s">'PEKN'</span><span class="p">,</span> <span class="s">'N23PP/PEKN/L28F'</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">r"Everything in the document can use m$\alpha$th language"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r"Rate (s$^{-1}$)"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Mutant"</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'left'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'bottom'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'test.png'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre>
</figure>

<p>In this code, I start with two lists, one of y values and one of error values, and proceed to make a named bar chart.
I also throw a line graph on top for illustrative purposes and add some axis labels and a title. 
You’ll notice that I actually cheated and did a little bit of formatting in the code: I added padding between the title and axis labels and the graph, and I got rid of the tickmarks on the right and top sides of the graph. 
This is because these are not settings that can be affected by the matplotlibrc, so it is unavoidable to include them.</p>

<p>The results for this code are below. It is fraught with problems. 
Most obviously, the colors are unpleasant and more importantly unclear. 
Because the bar objects and the error bars are the same shade of blue, the lower half of the error bars become invisible.
Furthermore, the line that is overlaid is narrow and a difficult shade of green that is particularly unpleasant when overlaid above the blue of the bars.
The axis labels are also problematic. First, they are too small and as a result difficult to read. 
Further, the special formatting (such as use of greek letters and superscripts) uses a distinct font compared to the rest of the text, which makes the labels even more difficult to read.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test_no_rc.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p>In order to highlight the ugliness of the default color cycle in python, I have attached a second, simpler piece of code and its output:</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mo">01</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">datum</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'left'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'bottom'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Color Cycle, demonstrated"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r"$sin(x^{2}+\lambda{})$"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r"x"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'test2.png'</span><span class="p">)</span></code></pre>
</figure>

<p>This code draws a lot of lines which become closer and closer to each other.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test2_no_rc.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p>The linewidth problem is apparent here, but just as apparent is the inappropriateness of the high-contrast default colors.</p>

<h2 id="writing-a-matplotlibrc-to-fix-things">Writing a matplotlibrc to fix things</h2>

<p>Matplotlibrc files work by adding settings to a text file in the format <code class="highlighter-rouge">option_name: option</code>. I made changes to less noticeable things like the backend and the display size and resolution, as well as turning on the “autolayout” option that I find makes much better use of the available space, but in terms of the major problems I discussed above, I made changes in 5 main areas.</p>

<h3 id="lines">Lines</h3>
<p>The first thing I did with the lines was to increase the linewidth, so that the lines have a nice weight. Additionally, I turned on anti-aliasing, and introduced rounding at the line edges. In addition to the changes in color detailed below, the effect is quite dramatic. These changes also apply to error bars, and the readability improvement for those is dramatic.</p>

<h3 id="colors">Colors</h3>
<p>I introduced a new color cycle, taken from <a href="http://www.mulinblog.com/a-color-palette-optimized-for-data-visualization/">this blog</a>, which in turn took it from <a href="http://www.amazon.com/Show-Me-Numbers-Designing-Enlighten/dp/0970601972/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1376149971&amp;sr=1-1&amp;keywords=show+me+the+numbers">Stephen Few’s book “Show Me The Numbers: Designing Tables and Graphs to Enlighten”</a>. This color wheel applies to objects such as lines and error bars. It brings colors much closer to the pastel range, and they sit next to eachother well without creating bad contrast, while still being readily distinguishable. Combined with the improvements to the line shape, the effect is a much clearer, softer line compared to the narrow, harsh colored lines of the default settings.</p>

<h3 id="shapes">Shapes</h3>
<p>I gave the bars in barcharts and other such shapes a light grey color, which stands out while also allowing other objects such as error bars to be overlaid very clearly. I gave them a thicker, darker grey outline, which gave them a softer gradient than the default black outline. Overall, these objects play very well with the grid, line and error bar overlays, and overlaid text (not shown).</p>

<h3 id="text">Text</h3>
<p>I made significant changes in the font. I immediately increased the font size for the axis labels and the title, to 18 and 24 points respectively. With the increased DPI (discussed above) the effective font size is significantly larger. I also adjusted the font selection to be more math-friendly, so that I could accomplish my second goal: making sure that the mathtext (for things like superscripts) looks identical to the normal font. Right now, Arial is the first preference for fonts, followed by helvetica. Changing to a serif font in the script will continue to use math-friendly fonts. Overall, the text is much more consistent looking and much more clear. Math displayed in the arial font is not as pretty, in my honest opinion, as the defaults, but the continuity with the rest of the text is worth the sacrifice.</p>

<h3 id="grid-and-tickmarks">Grid and Tickmarks</h3>
<p>I turned the tickmarks to face outwards instead of inwards. This has a few effects, including giving clearer marks in particular in busy areas of the graph, as well as placing more spacing between the tick labels and the chart itself. I also further added to the padding between the tickmarks and the tick labels. To extend the tickmarks inwards to the graph itself, I turned on the grid, gave it a very light gray color, and placed it behind all other objects drawn on the chart.</p>

<h2 id="the-results">The results</h2>

<p>These are the same scripts as above, run with the new matplotlibrc and no other changes. I am very happy with the output, although no doubt I will continue to tweak it as time goes on! I would appreciate feedback as always. Again, like I said above, you can find the matplotlibrc at my <a href="https://github.com/bbarad/matplotlibrc">github page</a>. Contributions are welcome there as well as in the comments.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test2.png" alt="Before updating the matplotlibrc" width="640" /></p>

  </div>

  <hr>
  <h2><a href="/2014/08/20/Figures-with-Python/">Making Publication-quality Charts using Python and Matplotlib</a></h2>
  <p class="author">
    <span class="author"><a href="/members#Ben Barad">Ben Barad</a></span><br>
    <span class="date"><em>20 August 2014</em></span>
  </p>
  <div class="content">
    <p><em>I originally wrote this article for my <a href="http://benjaminbarad.com">personal website</a>, but I think it is relevant here, so with James’s blessing I am crossposting it.</em></p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test_no_title.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p><a href="https://www.python.org/">Python</a> is currently my programming language of choice. It is the programming language taught by my graduate program to incoming first years, and in my experience it is the most common scripting language used by the scientists around me. The Fraser lab uses python almost exclusively for programming.</p>

<p>Because of this, when I want to work with data my first instinct is to go to python. Python is very effective for importing data, doing all of the manipulations necessary, and performing statistical tests. Ultimately, while I am aware that there are a multitude of <a href="http://www.r-project.org/">other</a> <a href="http://julialang.org/">tools</a> available, I would rather stick with python.</p>

<p>In my experience, the most painful part of using python for data analysis is <strong>visualization</strong>. Plotting in python is primarily accomplished via <a href="http://matplotlib.org/">Matplotlib</a>. I find the syntax fairly straightforward, but the default output of the charts leave much to be desired. In particular, I find myself messing with the spacing between the labels and the graph, the size of the labels and title, the linewidth, the colors of the objects, and the visual appearance of the regular tickmarks all to make a single figure look appealing enough to share with my peers. Trying to do this consistently is even more maddening, as it ultimately results in even more boilerplate code.</p>

<p>I ultimately (mostly) solved this problem by creating a matplotlibrc file which automatically imports a number of settings for every chart I choose to work with. My matplotlibrc file lives in a <a href="https://github.com/bbarad/matplotlibrc">github repository</a> where you can freely grab and modify it. Just put it in your <code class="highlighter-rouge">~/.matplotlib/</code> folder. I also thought I would use this space to talk about the decisions I made in designing the matplotlibrc to get as close as possible to publication quality images with no special styles in the python code.</p>

<!--break-->

<h2 id="matplotlibs-defaults-are-unsuitable-for-any-professional-purpose">Matplotlib’s defaults are unsuitable for any professional purpose</h2>

<p>The best way for me to show the problems with the defaults in matplotlib is to show the output of a small snippet of code:</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">220</span><span class="p">,</span><span class="mf">14.2</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">420</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">"center"</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="s">'wt'</span><span class="p">,</span> <span class="s">'N23PP'</span><span class="p">,</span> <span class="s">'N23PP/PEKN'</span><span class="p">,</span> <span class="s">'PEKN'</span><span class="p">,</span> <span class="s">'N23PP/PEKN/L28F'</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">r"Everything in the document can use m$\alpha$th language"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r"Rate (s$^{-1}$)"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Mutant"</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'left'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'bottom'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'test.png'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre>
</figure>

<p>In this code, I start with two lists, one of y values and one of error values, and proceed to make a named bar chart.
I also throw a line graph on top for illustrative purposes and add some axis labels and a title. 
You’ll notice that I actually cheated and did a little bit of formatting in the code: I added padding between the title and axis labels and the graph, and I got rid of the tickmarks on the right and top sides of the graph. 
This is because these are not settings that can be affected by the matplotlibrc, so it is unavoidable to include them.</p>

<p>The results for this code are below. It is fraught with problems. 
Most obviously, the colors are unpleasant and more importantly unclear. 
Because the bar objects and the error bars are the same shade of blue, the lower half of the error bars become invisible.
Furthermore, the line that is overlaid is narrow and a difficult shade of green that is particularly unpleasant when overlaid above the blue of the bars.
The axis labels are also problematic. First, they are too small and as a result difficult to read. 
Further, the special formatting (such as use of greek letters and superscripts) uses a distinct font compared to the rest of the text, which makes the labels even more difficult to read.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test_no_rc.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p>In order to highlight the ugliness of the default color cycle in python, I have attached a second, simpler piece of code and its output:</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mo">01</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">datum</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'left'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">'bottom'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Color Cycle, demonstrated"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r"$sin(x^{2}+\lambda{})$"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r"x"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'test2.png'</span><span class="p">)</span></code></pre>
</figure>

<p>This code draws a lot of lines which become closer and closer to each other.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test2_no_rc.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p>The linewidth problem is apparent here, but just as apparent is the inappropriateness of the high-contrast default colors.</p>

<h2 id="writing-a-matplotlibrc-to-fix-things">Writing a matplotlibrc to fix things</h2>

<p>Matplotlibrc files work by adding settings to a text file in the format <code class="highlighter-rouge">option_name: option</code>. I made changes to less noticeable things like the backend and the display size and resolution, as well as turning on the “autolayout” option that I find makes much better use of the available space, but in terms of the major problems I discussed above, I made changes in 5 main areas.</p>

<h3 id="lines">Lines</h3>
<p>The first thing I did with the lines was to increase the linewidth, so that the lines have a nice weight. Additionally, I turned on anti-aliasing, and introduced rounding at the line edges. In addition to the changes in color detailed below, the effect is quite dramatic. These changes also apply to error bars, and the readability improvement for those is dramatic.</p>

<h3 id="colors">Colors</h3>
<p>I introduced a new color cycle, taken from <a href="http://www.mulinblog.com/a-color-palette-optimized-for-data-visualization/">this blog</a>, which in turn took it from <a href="http://www.amazon.com/Show-Me-Numbers-Designing-Enlighten/dp/0970601972/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1376149971&amp;sr=1-1&amp;keywords=show+me+the+numbers">Stephen Few’s book “Show Me The Numbers: Designing Tables and Graphs to Enlighten”</a>. This color wheel applies to objects such as lines and error bars. It brings colors much closer to the pastel range, and they sit next to eachother well without creating bad contrast, while still being readily distinguishable. Combined with the improvements to the line shape, the effect is a much clearer, softer line compared to the narrow, harsh colored lines of the default settings.</p>

<h3 id="shapes">Shapes</h3>
<p>I gave the bars in barcharts and other such shapes a light grey color, which stands out while also allowing other objects such as error bars to be overlaid very clearly. I gave them a thicker, darker grey outline, which gave them a softer gradient than the default black outline. Overall, these objects play very well with the grid, line and error bar overlays, and overlaid text (not shown).</p>

<h3 id="text">Text</h3>
<p>I made significant changes in the font. I immediately increased the font size for the axis labels and the title, to 18 and 24 points respectively. With the increased DPI (discussed above) the effective font size is significantly larger. I also adjusted the font selection to be more math-friendly, so that I could accomplish my second goal: making sure that the mathtext (for things like superscripts) looks identical to the normal font. Right now, Arial is the first preference for fonts, followed by helvetica. Changing to a serif font in the script will continue to use math-friendly fonts. Overall, the text is much more consistent looking and much more clear. Math displayed in the arial font is not as pretty, in my honest opinion, as the defaults, but the continuity with the rest of the text is worth the sacrifice.</p>

<h3 id="grid-and-tickmarks">Grid and Tickmarks</h3>
<p>I turned the tickmarks to face outwards instead of inwards. This has a few effects, including giving clearer marks in particular in busy areas of the graph, as well as placing more spacing between the tick labels and the chart itself. I also further added to the padding between the tickmarks and the tick labels. To extend the tickmarks inwards to the graph itself, I turned on the grid, gave it a very light gray color, and placed it behind all other objects drawn on the chart.</p>

<h2 id="the-results">The results</h2>

<p>These are the same scripts as above, run with the new matplotlibrc and no other changes. I am very happy with the output, although no doubt I will continue to tweak it as time goes on! I would appreciate feedback as always. Again, like I said above, you can find the matplotlibrc at my <a href="https://github.com/bbarad/matplotlibrc">github page</a>. Contributions are welcome there as well as in the comments.</p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test.png" alt="Before updating the matplotlibrc" width="640" /></p>

<p><img class="img-responsive center-block" src="/static/img/matplotlib/test2.png" alt="Before updating the matplotlibrc" width="640" /></p>

  </div>

<hr>

<!-- This makes links to other paginator pages -->

<ul class="pagination">
  
    <li><a href="/news/page2">&laquo; Prev</a></li>
  

  
    
      <li><a href="/news">1</a></li>
    
  
    
      <li><a href="/news/page2">2</a></li>
    
  
    
      <li class="active"><span>3</span></li>
    
  
    
      <li><a href="/news/page4">4</a></li>
    
  
    
      <li><a href="/news/page5">5</a></li>
    
  
    
      <li><a href="/news/page6">6</a></li>
    
  
    
      <li><a href="/news/page7">7</a></li>
    
  
    
      <li><a href="/news/page8">8</a></li>
    
  
    
      <li><a href="/news/page9">9</a></li>
    
  
    
      <li><a href="/news/page10">10</a></li>
    
  
    
      <li><a href="/news/page11">11</a></li>
    
  
    
      <li><a href="/news/page12">12</a></li>
    
  
    
      <li><a href="/news/page13">13</a></li>
    
  

  
    <li><a href="/news/page4">Next &raquo;</a></li>
  
</ul>


    </div>
    <div class="col-sm-5 col-md-4 hidden-xs">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/fraser_lab" data-widget-id="486191843416092672">Tweets by @fraser_lab</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>


    </div>
</div>

    </div>
    <hr>
    <div id="footer footer-fixed-bottom">
      <div class="container">
        <p class="text-muted credit"> This website is open-source and available on <a href="https://github.com/fraser-lab/fraser-lab.github.io">Github</a>.</p>
      </div>
    </div>

     <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
    <script src="/static/js/bootstrap.min.js"></script>
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-52773332-1', 'auto');
      ga('send', 'pageview');
    
    </script>
  </body>
</html>
